import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as r,c,a,e,d as n,w as s,b as d}from"./app-jqRUl9Zf.js";const o={},p=d('<h1 id="更新面板" tabindex="-1"><a class="header-anchor" href="#更新面板"><span>更新面板</span></a></h1><p>本文档涵盖了 <code>1.x</code> 系列版本中的更新过程。这意味着例如从 <code>1.5.0</code> 更新到 <code>1.6.0</code>。<strong>请勿使用本指南从 <code>0.7</code> 开始升级，这会导致你升级失败。</strong></p><h2 id="面板的版本要求" tabindex="-1"><a class="header-anchor" href="#面板的版本要求"><span>面板的版本要求</span></a></h2><p>翼龙面板的每个版本都有相应最低版本的 Wings。请参阅下表了解有关这些对应版本。在大多数情况下，您的 Wings 版本应该与您的面板版本相匹配。</p><table><thead><tr><th>面板版本</th><th>Wings 版本</th><th>支持状况</th><th>PHP 版本</th></tr></thead><tbody><tr><td>1.0.x</td><td>1.0.x</td><td></td><td>7.3, 7.4</td></tr><tr><td>1.1.x</td><td>1.1.x</td><td></td><td>7.3, 7.4</td></tr><tr><td>1.2.x</td><td>1.2.x</td><td></td><td>7.3, 7.4</td></tr><tr><td>1.3.x</td><td>1.3.x</td><td></td><td>7.4, 8.0</td></tr><tr><td>1.4.x</td><td>1.4.x</td><td></td><td>7.4, 8.0</td></tr><tr><td>1.5.x</td><td>1.4.x</td><td></td><td>7.4, 8.0</td></tr><tr><td>1.6.x</td><td>1.4.x</td><td></td><td>7.4, 8.0</td></tr><tr><td>1.7.x</td><td>1.5.x</td><td></td><td>7.4, 8.0</td></tr><tr><td>1.8.x</td><td>1.6.x</td><td></td><td>7.4, 8.0, 8.1</td></tr><tr><td>1.9.x</td><td>1.6.x</td><td></td><td>7.4, 8.0, 8.1</td></tr><tr><td>1.10.x</td><td>1.7.x</td><td></td><td>7.4, 8.0, 8.1</td></tr><tr><td><strong>1.11.x</strong></td><td><strong>1.11.x</strong></td><td>✅</td><td>8.0, <strong>8.1</strong> (8.0 弃用)</td></tr></tbody></table><p><em>注意：Wings 没有 1.8.x、1.9.x 或 1.10.x 版本。</em></p><h2 id="更新依赖项" tabindex="-1"><a class="header-anchor" href="#更新依赖项"><span>更新依赖项</span></a></h2><ul><li>PHP <code>8.0</code> 或 <code>8.1</code> (推荐)</li><li>Composer <code>2.X</code></li></ul><div class="hint-container caution"><p class="hint-container-title">PHP 7.4</p><p>随着 1.11.0 的发布，对 PHP 7.4 的支持已被移除。请升级到 PHP 8.0、8.1 或更高版本。</p></div><div class="hint-container warning"><p class="hint-container-title">受支持的 PHP 最低版本已更改</p><p><strong>对 PHP 8.0 的支持已弃用</strong>。请相应地计划——PHP 8.1 或更高版本将是 1.12 及更高版本中唯一受支持的版本。</p></div>',10),h=a("strong",null,"在继续之前",-1),u=a("code",null,"php -v",-1),v=a("code",null,"composer --version",-1),m=d(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>vagrant@pterodactyl:~/app$ php -v
PHP 8.1.5 (cli) (built: Apr 21 2022 10:32:13) (NTS)
Copyright (c) The PHP Group
Zend Engine v4.1.5, Copyright (c) Zend Technologies
    with Zend OPcache v8.1.5, Copyright (c), by Zend Technologies

vagrant@pterodactyl:~/app$ composer --version
Composer version 2.3.5 2022-04-13 16:43:00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自动升级" tabindex="-1"><a class="header-anchor" href="#自动升级"><span>自动升级</span></a></h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p>由于我们使用的一些依赖项存在问题，目前无法进行自动升级。请暂时执行人工升级的方式，直到此问题得到解决。</p></div><h2 id="人工升级" tabindex="-1"><a class="header-anchor" href="#人工升级"><span>人工升级</span></a></h2><p>如果您不想执行自动升级，或者想要参考升级步骤，您可以按照下面的文档进行操作。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果您已成功执行自动升级，则无需在此页面上执行任何其他操作。</p></div><h3 id="进入维护模式" tabindex="-1"><a class="header-anchor" href="#进入维护模式"><span>进入维护模式</span></a></h3><p>每当您执行更新时，您应该确保将您的面板置于维护模式。这将防止用户遇到意外的错误，这样能确保用户在升级完成之前无法对面板进行任何操作，你也能更好的去更新。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /var/www/pterodactyl

php artisan down
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="下载更新" tabindex="-1"><a class="header-anchor" href="#下载更新"><span>下载更新</span></a></h3><p>更新过程的第一步是从 GitHub 下载新的面板文件。下面的命令将下载翼龙中国最新发布的版本，将其保存在当前目录中，并自动解压到您的当前文件夹中。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-L</span> https://github.com/pterodactyl-china/panel/releases/latest/download/panel.tar.gz <span class="token operator">|</span> <span class="token function">tar</span> <span class="token parameter variable">-xzv</span>
<span class="token comment"># 若阁下在上条指令上无法正常拉取压缩包或者拉取缓慢 可使用 gh-proxy 提供的CF反向代理来拉取</span>
<span class="token function">curl</span> <span class="token parameter variable">-L</span> https://mirror.ghproxy.com/https://github.com/pterodactyl-china/panel/releases/latest/download/panel.tar.gz <span class="token operator">|</span> <span class="token function">tar</span> <span class="token parameter variable">-xzv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下载所有文件后，我们需要将缓存与存储目录上设置正确的权限，以避免与网络服务器出现相关的错误。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">755</span> storage/* bootstrap/cache
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="更新依赖" tabindex="-1"><a class="header-anchor" href="#更新依赖"><span>更新依赖</span></a></h3><p>下载所有新文件后，您需要升级面板的核心组件。为此，只需运行以下命令并按照提示进行操作。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">composer</span> <span class="token function">install</span> --no-dev --optimize-autoloader
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="清除编译后的模板缓存" tabindex="-1"><a class="header-anchor" href="#清除编译后的模板缓存"><span>清除编译后的模板缓存</span></a></h3><p>您还需要清除已编译的模板缓存，以确保新的还有修改过的模板正确地显示给用户。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>php artisan view:clear
php artisan config:clear
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数据库更新" tabindex="-1"><a class="header-anchor" href="#数据库更新"><span>数据库更新</span></a></h3><p>您还需要为最新版本的翼龙更新数据库结构。运行下面的命令将更新结构并确保我们发布的默认预设是最新的（并添加我们可能发布的新预设）。请记住，<em>永远不要编辑我们发布的核心预设</em>！ 它们将被此更新过程所覆盖。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>php artisan migrate <span class="token parameter variable">--seed</span> <span class="token parameter variable">--force</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="设置权限" tabindex="-1"><a class="header-anchor" href="#设置权限"><span>设置权限</span></a></h3><p>最后一步是将文件的所有者设置为您的网络服务器用户。在大多数情况下是 <code>www-data</code>，但可能因系统而异 — 有时是 <code>nginx</code>、<code>caddy</code>、<code>apache</code>，甚至是 <code>nobody</code>。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 如果使用 NGINX 或 Apache (并且不在CentOS上)</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> www-data:www-data /var/www/pterodactyl/*

<span class="token comment"># 如果在 CentOS 上使用 NGINX</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> nginx:nginx /var/www/pterodactyl/*

<span class="token comment"># 如果在 CentOS 上使用 Apache</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> apache:apache /var/www/pterodactyl/*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重启工作队列" tabindex="-1"><a class="header-anchor" href="#重启工作队列"><span>重启工作队列</span></a></h3><p><em>每次</em> 更新后，您都应该重新启动工作队列程序，以确保新的代码已加载并使用。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>php artisan queue:restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="退出维护模式" tabindex="-1"><a class="header-anchor" href="#退出维护模式"><span>退出维护模式</span></a></h3><p>现在所有内容都已更新，您需要退出维护模式，以便面板可以继续运行并提供服务。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>php artisan up
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="遥测" tabindex="-1"><a class="header-anchor" href="#遥测"><span>遥测</span></a></h3>`,33);function g(b,x){const t=l("RouteLink");return r(),c("div",null,[p,a("p",null,[h,e("，请确保您的系统和网络服务器配置已通过运行 "),u,e(" 和 "),v,e(" 来确认您的服务器已在 PHP 8.0 和 Composer 2 或更高的版本。您应该会看到类似于以下输出的结果。如果您没有看到 PHP 8.0 和 Composer 2 或更高的版本，您将需要按照我们的 "),n(t,{to:"/guides/php_upgrade.html"},{default:s(()=>[e("PHP 升级指南")]),_:1}),e(" 进行升级，然后再返回此文档。")]),m,a("p",null,[e("从 1.11 开始，Pterodactyl 将收集匿名遥测数据，以帮助我们更好地了解软件的使用情况。要了解有关此功能的更多信息并拒绝此功能，请参阅我们的 "),n(t,{to:"/panel/1.0/additional_configuration.html#%E9%81%A5%E6%B5%8B"},{default:s(()=>[e("遥测")]),_:1}),e(" 文档。确保继续其余的安装过程。")]),a("p",null,[n(t,{to:"/wings/1.0/upgrading.html"},{default:s(()=>[e("最后一步：升级 Wings")]),_:1})])])}const w=i(o,[["render",g],["__file","updating.html.vue"]]),y=JSON.parse('{"path":"/panel/1.0/updating.html","title":"更新面板","lang":"zh-CN","frontmatter":{"description":"更新面板 本文档涵盖了 1.x 系列版本中的更新过程。这意味着例如从 1.5.0 更新到 1.6.0。请勿使用本指南从 0.7 开始升级，这会导致你升级失败。 面板的版本要求 翼龙面板的每个版本都有相应最低版本的 Wings。请参阅下表了解有关这些对应版本。在大多数情况下，您的 Wings 版本应该与您的面板版本相匹配。 注意：Wings 没有 1.8...","head":[["meta",{"property":"og:url","content":"https://pterodactyl.top/panel/1.0/updating.html"}],["meta",{"property":"og:site_name","content":"Pterodactyl-China"}],["meta",{"property":"og:title","content":"更新面板"}],["meta",{"property":"og:description","content":"更新面板 本文档涵盖了 1.x 系列版本中的更新过程。这意味着例如从 1.5.0 更新到 1.6.0。请勿使用本指南从 0.7 开始升级，这会导致你升级失败。 面板的版本要求 翼龙面板的每个版本都有相应最低版本的 Wings。请参阅下表了解有关这些对应版本。在大多数情况下，您的 Wings 版本应该与您的面板版本相匹配。 注意：Wings 没有 1.8..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-13T13:28:57.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-13T13:28:57.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"更新面板\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-13T13:28:57.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"面板的版本要求","slug":"面板的版本要求","link":"#面板的版本要求","children":[]},{"level":2,"title":"更新依赖项","slug":"更新依赖项","link":"#更新依赖项","children":[]},{"level":2,"title":"自动升级","slug":"自动升级","link":"#自动升级","children":[]},{"level":2,"title":"人工升级","slug":"人工升级","link":"#人工升级","children":[{"level":3,"title":"进入维护模式","slug":"进入维护模式","link":"#进入维护模式","children":[]},{"level":3,"title":"下载更新","slug":"下载更新","link":"#下载更新","children":[]},{"level":3,"title":"更新依赖","slug":"更新依赖","link":"#更新依赖","children":[]},{"level":3,"title":"清除编译后的模板缓存","slug":"清除编译后的模板缓存","link":"#清除编译后的模板缓存","children":[]},{"level":3,"title":"数据库更新","slug":"数据库更新","link":"#数据库更新","children":[]},{"level":3,"title":"设置权限","slug":"设置权限","link":"#设置权限","children":[]},{"level":3,"title":"重启工作队列","slug":"重启工作队列","link":"#重启工作队列","children":[]},{"level":3,"title":"退出维护模式","slug":"退出维护模式","link":"#退出维护模式","children":[]},{"level":3,"title":"遥测","slug":"遥测","link":"#遥测","children":[]}]}],"git":{"createdTime":1615060103000,"updatedTime":1713014937000,"contributors":[{"name":"飒爽师叔","email":"43847794+vlssu@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":4.38,"words":1314},"filePathRelative":"panel/1.0/updating.md","localizedDate":"2021年3月6日","autoDesc":true}');export{w as comp,y as data};
